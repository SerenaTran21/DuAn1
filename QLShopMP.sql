CREATE DATABASE QLSHOPMYPHAM
USE QLSHOPMYPHAM
GO

GO
CREATE TABLE LOAISP(
MaLoai INT IDENTITY(1,1) PRIMARY KEY,
TenLoai NVARCHAR (100)
);

GO
CREATE TABLE THUONGHIEU(
MaThuongHieu INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
TenThuongHieu NVARCHAR (100)
);


GO
CREATE TABLE SANPHAM(
MaSP INT PRIMARY KEY IDENTITY (1,1) NOT NULL,
TenSP NVARCHAR(255),
GiaBan FLOAT,
Hinh NVARCHAR(255),
MaVachSP NVARCHAR(255),
MaLoai INT,
MaThuongHieu INT,
FOREIGN KEY (MaLoai) REFERENCES LOAISP(MaLoai) ON DELETE NO ACTION ON UPDATE CASCADE,
FOREIGN KEY (MaThuongHieu) REFERENCES THUONGHIEU(MaThuongHieu) ON DELETE NO ACTION ON UPDATE CASCADE
);


GO
CREATE TABLE MAUSAC(
MaMau INT PRIMARY KEY IDENTITY (1,1) NOT NULL,
TenMau NVARCHAR(MAX),
HinhAnh NVARCHAR(MAX),
MaSP INT,
FOREIGN KEY (MaSP) REFERENCES SANPHAM(MaSP)
)

GO 
CREATE TABLE KIEMKE(
MaKiemKe INT PRIMARY KEY IDENTITY (1,1),
NgayTaoKiemKe DATE,
KyKiemKe  NVARCHAR(MAX),
MucDich NVARCHAR(MAX),
KetLuan NVARCHAR(MAX),
DaXuLy BIT
)


CREATE TABLE NHANVIEN(
MaNV INT PRIMARY KEY IDENTITY (1,1),
TenNV NVARCHAR(255),
GioiTinh bit,
NgaySinh DATE,
DiaChi NVARCHAR(255),
SDT NVARCHAR (11),
CCCD NVARCHAR(12),
Email NVARCHAR(255),
HinhAnh NVARCHAR(MAX),
UserName NVARCHAR(MAX),
Passwords NVARCHAR(MAX),
ChucVu BIT
);

GO 
CREATE TABLE CHITIETKIEMKE(
MaCTKiemKe INT PRIMARY KEY IDENTITY (1,1),
SoLuong INT,
VungKiemKe NVARCHAR(MAX),
NVDem1 INT,
NVDem2 INT,
NVDem3 INT,
MaSP INT,
MaKiemKe INT,
FOREIGN KEY (MaKiemKe) REFERENCES KIEMKE(MaKiemKe),
FOREIGN KEY (MaSP) REFERENCES SANPHAM(MaSP)
)

GO
CREATE TABLE KHACHHANG(
MaKH INT IDENTITY (1,1) PRIMARY KEY,
TenKH NVARCHAR(255),
GioiTinh NVARCHAR (3),
NgaySinh DATE,
DiaChi NVARCHAR(255),
SDT NVARCHAR (11),
);

GO
CREATE TABLE HOADON (
MaHD INT IDENTITY (1,1) PRIMARY KEY,
NgayTao DATE,
TongTien FLOAT,
Sale FLOAT,
ThanhTien FLOAT,
TrangThai BIT,
MaNV INT,
MaKH INT,
FOREIGN KEY (MaNV) REFERENCES NHANVIEN(MaNV),
FOREIGN KEY (MaKH) REFERENCES KHACHHANG(MaKH),
);

GO

GO
CREATE TABLE CTHD (
MaCTHD INT IDENTITY (1,1) PRIMARY KEY,
SL INT,
GIA FLOAT,
MaHD INT,
MaSP INT,
ThanhTien FLOAT,
TenMau NVARCHAR(MAX),
FOREIGN KEY (MaHD) REFERENCES HOADON(MaHD),
FOREIGN KEY (MaSP) REFERENCES SANPHAM(MaSP)
);
GO

GO
CREATE TABLE NHACUNGCAP(
MaNhaCungCap INT IDENTITY (1,1) PRIMARY KEY,
TenNhaCungCap NVARCHAR(MAX)
)

GO
CREATE TABLE PHIEUNHAP(
MaPN INT IDENTITY (1,1) PRIMARY KEY,
NgayTao DATE,
ThanhTien FLOAT,
ChietKhau INT,
TrangThai BIT,
MaNV INT NULL,
MaNhaCungCap INT,
FOREIGN KEY (MaNV) REFERENCES NHANVIEN(MaNV),
FOREIGN KEY (MaNhaCungCap)REFERENCES NHACUNGCAP(MaNhaCungCap)
);

GO
CREATE TABLE CTPN (
MaCTPN INT IDENTITY (1,1) PRIMARY KEY,
SL INT,
GiaNhap FLOAT,
ThanhTien FLOAT,
MaPN INT,
MaSP INT,
TenMau NVARCHAR(MAX),
FOREIGN KEY (MaPN) REFERENCES PHIEUNHAP(MaPN),
FOREIGN KEY (MaSP) REFERENCES SANPHAM(MaSP)
);

GO

--INSERT DỮ LIỆU
--LOẠI SẢN PHẨM
go
INSERT INTO LOAISP
VALUES
(N'Trang điểm'),
(N'Chăm sóc da'),
(N'Nước hoa')
--------------------------------INSERT THƯƠNG HIỆU----------------------------------------
INSERT INTO THUONGHIEU
VALUES
(N'YSL'),
(N'Maybeline'),
(N'The Ordinary'),
('Loreal'),
(N'Innisfree')
--------------------------------NHÀ CUNG CẤP---------------------------------------------
INSERT INTO NhaCungCap
VALUES
(N'Công Ty TNHH Optisay'),
(N'Unilever Việt Nam'),
(N'Công Ty TNHH Giffarine Việt Nam'),
(N'Công ty TNHH PMP'),
(N'Korean Cosmetics')
---------------------------------KIỂM KÊ ------------------------------
SELECT * FROM KIEMKE
INSERT INTO KIEMKE
VALUES
('2023-06-10',1),
('2023-07-10',2),
('2023-08-10',3),
('2023-09-10',4),
('2023-10-10',5)
---------------------------------INSERT DỮ LIỆU ------------------------------------------
GO
INSERT INTO SANPHAM
VALUES	
--lIST TRANG ĐIỂM
(N'SON ROUGE PUR COUTURE THE SLIM 2',1200000, N'SON ROUGE PUR COUTURE THE SLIM 2.jpg', NULL,1,1),
(N'SON MÔI ROUGE PUR COUTURE THE SLIM VELVET RADICAL',1200000, N'SON MÔI ROUGE PUR COUTURE THE SLIM VELVET RADICAL.jpg', NULL,1,3),
(N'SON KEM LÌ TATOUAGE COUTURE VELVET CREAM',1200000,N'SON KEM LÌ TATOUAGE COUTURE VELVET CREAM.jpg', NULL,1,3),
(N'SON THỎI SATIN LÌ THE BOLD',1200000, N'SON THỎI SATIN LÌ THE BOLD.jpg', NULL,1,4),
(N'BẢNG MẮT COUTURE COLOR CLUTCH',3800000, N'BẢNG MẮT COUTURE COLOR CLUTCH.jpg',NULL,1,5),
(N'CUSHION EDP LAMÉ COLLECTOR',1960000, N'CUSHION EDP LAMÉ COLLECTOR.jpg', NULL,1,3),
(N'MASCARA MVEFC WATERPROOF',1400000, N'MASCARA MVEFC WATERPROOF.jpg', NULL,1,1),
(N'PHẤN PHỦ SOUFFLE DECLAT',1900000, N'PHẤN PHỦ SOUFFLE DECLAT.jpg', NULL,1,1),
-- LIST CHĂM DA
(N'KEM CHỐNG NẮNG PURE SHOTS AIRTHIN UV DEFENDER',1200000,N'KEM CHỐNG NẮNG PURE SHOTS AIRTHIN UV DEFENDER.jpg',NULL,2,1),
(N'KEM DƯỠNG ẨM PURE SHOTS PERFECT PLUMPER',1200000,N'KEM DƯỠNG ẨM PURE SHOTS PERFECT PLUMPER.jpg',NULL,2,2),
(N'PURE SHOTS LINES AWAY SERUM',1200000,N'PURE SHOTS LINES AWAY SERUM.jpg',NULL,2,2),
(N'Tinh chất chống lão hóa, tái tạo da The Ordinary “Buffet”',1200000,N'Tinh chất chống lão hóa, tái tạo da The Ordinary “Buffet”.jpg',NULL,2,3),
(N'Tinh chất trị mụn The Ordinary Salicylic Acid 2% Solution (BHA)',1200000,N'Tinh chất trị mụn The Ordinary Salicylic Acid 2% Solution (BHA).jpg',NULL,2,2),
(N'Kem dưỡng ẩm The Ordinary',1200000,N'Kem dưỡng ẩm The Ordinary Natural Moisturizing Factor + HA.jpg',NULL,2,1),
(N'Serum dưỡng tóc The Ordinary',1200000,N'Serum dưỡng tóc The Ordinary.jpg',NULL,2,5),
(N'Tinh chất tẩy tế bào chết & cấp nước The Ordinary',1200000,N'Tinh chất tẩy tế bào chết & cấp nước The Ordinary.jpg',NULL,2,4),
--LIST NƯỚC HOA
(N'TÊN NƯỚC HOA1',200000,N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',NULL,3,3),
(N'TÊN NƯỚC HOA1',200000,N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',NULL,3,3),
(N'TÊN NƯỚC HOA1',200000,N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',NULL,3,3),
(N'TÊN NƯỚC HOA1',200000,N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',NULL,3,3),
(N'TÊN NƯỚC HOA1',200000,N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',NULL,3,3),
(N'TÊN NƯỚC HOA1',200000,N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',NULL,3,3),
(N'TÊN NƯỚC HOA1',200000,N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',NULL,3,3),
(N'TÊN NƯỚC HOA1',200000,N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',NULL,3,3),
(N'TÊN NƯỚC HOA1',200000,N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',NULL,3,3),
(N'TÊN NƯỚC HOA1',200000,N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',NULL,3,3)


---------------------------------MÀU SẮC-----------------------------
SELECT * FROM MAUSAC
INSERT INTO MAUSAC
VALUES(N'Hồng Đất',NULL,1),
(N'Đỏ rượu',NULL,1),
(N'Cam san hô',NULL,1),
(N'Cam ',NULL,1),
(N'Đỏ đất',NULL,1),
(N'Cam đất',NULL,1)

---------------------------------CHI TIẾT KIỂM KÊ ------------------------------
SELECT * FROM CHITIETKIEMKE
INSERT INTO CHITIETKIEMKE
VALUES
(98,N'Kho hàng Cần Thơ', 1,NULL,NULL,1,1),
(98,N'Kho hàng Cần Thơ', 2,NULL,NULL,2,2),
(98,N'Kho hàng Cần Thơ', 3,NULL,NULL,3,3),
(98,N'Kho hàng Cần Thơ', 4,NULL,NULL,4,4),
(98,N'Kho hàng Cần Thơ', 5,NULL,NULL,5,5)
--KHÁCH HÀNG
GO
SET IDENTITY_INSERT KHACHHANG OFF;
INSERT INTO KHACHHANG
VALUES
(N'Phạm Trí Phúc',1,'2004-11-25',N'Cà Mau','0791234212'),
(N'Dương Văn Kha',1,'2004-05-28',N'Hậu Giang','0791234211'),
(N'Phạm Minh Đức',1,'2004-11-25',N'Cà Mau','0791234213'),
(N'Trần Ngọc Anh Thư',0,'2004-11-25',N'Cà Mau','0791234214'),
(N'Hồ Thị Trúc Ly',0,'2004-11-25',N'Cà Mau','0791234216'),
(N'Hồ Trúc Ly',0,'2004-11-25',N'Cà Mau','0791234215'),
(N'Phan Văn Khánh',1,'2004-11-25',N'Cà Mau','0791234217'),
(N'Đặng Vĩnh Kỳ',1,'2004-11-25',N'Cà Mau','0791234218'),
(N'Nguyễn Vũ Đầy',1,'2004-11-25',N'Cà Mau','0791234219'),
(N'Võ Nhựt Duy',1,'2004-11-25',N'Cà Mau','0791234222'),
(N'Lê Tuấn Kiệt',1,'2004-11-25',N'Cà Mau','0791234232'),
(N'Đinh Văn Phát',1,'2004-11-25',N'Cà Mau','0791234242'),
(N'Trần Văn Nghĩa',1,'2004-11-25',N'Cà Mau','0791234252'),
(N'Trần Tô Phước Triều',1,'2004-11-25',N'Cà Mau','0791234262'),
(N'Nguyễn Minh Triệu',1,'2004-11-25',N'Cà Mau','0791234272'),
(N'Trần Nguyễn Đông Duy',1,'2004-11-25',N'Cà Mau','0791234282'),
(N'Tống Bình Phú',1,'2004-11-25',N'Cà Mau','0791234292'),
(N'Nguyễn Tuấn Khôi',1,'2004-11-25',N'Cà Mau','0791235212'),
(N'Nguyễn Minh Khanh',1,'2004-11-25',N'Cà Mau','0791236212'),
(N'Thạch Hoài An',1,'2004-11-25',N'Cà Mau','0791237212')
SET IDENTITY_INSERT KHACHHANG ON;

--NHÂN VIÊN
GO
INSERT INTO NHANVIEN
VALUES
(N'Nguyễn Thanh Hiếu',0,'2003-08-11',N'Cà Mau',N'0797932451',N'092132123123',N'thanhhieu@gmail.com',NULL,'ThanhHieu',CONVERT(NVARCHAR(32), HashBytes('MD5', '123'),2),1),
(N'Nguyễn Minh Tâm',0,'2003-08-11',N'Cà Mau',N'0797932452',N'092132123124',N'minhtam@gmail.com',NULL,'MinhTam',CONVERT(NVARCHAR(32), HashBytes('MD5', '123'),2),0),
(N'Nguyễn Trần Lượng',0,'2003-08-11',N'Cà Mau',N'0797932453',N'092132123125',N'tranluong@gmail.com',NULL,'TranLuong',CONVERT(NVARCHAR(32), HashBytes('MD5', '123'),2),0),
(N'Nguyễn Khánh Tâm',0,'2003-08-11',N'Cà Mau',N'0797932454',N'092132123126',N'khanhtam@gmail.com',NULL,'KhanhTam',CONVERT(NVARCHAR(32), HashBytes('MD5', '123'),2),0),
(N'Nguyễn Tuấn Huy',0,'2003-08-11',N'Cà Mau',N'0797932455',N'092132123127',N'tuanhuy@gmail.com',NULL,'TuanHuy',CONVERT(NVARCHAR(32), HashBytes('MD5', '123'),2),0)
--HÓA ĐƠN
GO
SELECT * FROM HOADON
INSERT INTO HOADON
VALUES
('2023-10-08',5700000,0.02,5586000,1,1,4),
('2023-10-09',5700000,0.02,5586000,1,3,1),
('2023-10-10',5700000,0.02,5586000,1,3,2),
('2023-10-11',5700000,0.02,5586000,1,1,3),
('2023-10-12',5700000,0.02,5586000,1,5,5),
('2023-10-13',5700000,0.02,5586000,1,5,4),
--THÁNG 1
('2022-01-01',24000000,0,24000000,1,4,10),
('2022-01-02',24000000,0,24000000,1,5,11),
('2022-01-03',24000000,0,24000000,1,3,11),
('2022-01-04',24000000,0,24000000,1,4,12),
('2022-01-05',24000000,0,24000000,1,5,13),
('2022-01-06',24000000,0,24000000,1,4,14),
('2022-01-07',24000000,0,24000000,1,5,15),
('2022-01-08',24000000,0,24000000,1,3,16),
('2022-01-09',24000000,0,24000000,1,4,17),
('2022-01-10',24000000,0,24000000,1,5,18),

('2022-01-11',24000000,0,24000000,1,4,10),
('2022-01-12',24000000,0,24000000,1,5,11),
('2022-01-13',24000000,0,24000000,1,3,11),
('2022-01-14',24000000,0,24000000,1,4,12),
('2022-01-15',24000000,0,24000000,1,5,13),
('2022-01-16',24000000,0,24000000,1,4,14),
('2022-01-17',24000000,0,24000000,1,5,15),
('2022-01-18',24000000,0,24000000,1,3,16),
('2022-01-19',24000000,0,24000000,1,4,17),
('2022-01-20',24000000,0,24000000,1,5,18),
--THÁNG 2
('2022-02-01',24000000,0,24000000,1,4,10),
('2022-02-02',24000000,0,24000000,1,5,11),
('2022-02-03',24000000,0,24000000,1,3,11),
('2022-02-04',24000000,0,24000000,1,4,12),
('2022-02-05',24000000,0,24000000,1,5,13),
('2022-02-06',24000000,0,24000000,1,4,14),
('2022-02-07',24000000,0,24000000,1,5,15),
('2022-02-08',24000000,0,24000000,1,3,16),
('2022-02-09',24000000,0,24000000,1,4,17),
('2022-02-10',24000000,0,24000000,1,5,18),

('2022-02-11',24000000,0,24000000,1,4,10),
('2022-02-12',24000000,0,24000000,1,5,11),
('2022-02-13',24000000,0,24000000,1,3,11),
('2022-02-14',24000000,0,24000000,1,4,12),
('2022-02-15',24000000,0,24000000,1,5,13),
('2022-02-16',24000000,0,24000000,1,4,14),
('2022-02-17',24000000,0,24000000,1,5,15),
('2022-02-18',24000000,0,24000000,1,3,16),
('2022-02-19',24000000,0,24000000,1,4,17),
('2022-02-20',24000000,0,24000000,1,5,18),
--THÁNG 3
('2022-03-01',24000000,0,24000000,1,4,10),
('2022-03-02',24000000,0,24000000,1,5,11),
('2022-03-03',24000000,0,24000000,1,3,11),
('2022-03-04',24000000,0,24000000,1,4,12),
('2022-03-05',24000000,0,24000000,1,5,13),
('2022-03-06',24000000,0,24000000,1,4,14),
('2022-03-07',24000000,0,24000000,1,5,15),
('2022-03-08',24000000,0,24000000,1,3,16),
('2022-03-09',24000000,0,24000000,1,4,17),
('2022-03-10',24000000,0,24000000,1,5,18),

('2022-03-11',24000000,0,24000000,1,4,10),
('2022-03-12',24000000,0,24000000,1,5,11),
('2022-03-13',24000000,0,24000000,1,3,11),
('2022-03-14',24000000,0,24000000,1,4,12),
('2022-03-15',24000000,0,24000000,1,5,13),
('2022-03-16',24000000,0,24000000,1,4,14),
('2022-03-17',24000000,0,24000000,1,5,15),
('2022-03-18',24000000,0,24000000,1,3,16),
('2022-03-19',24000000,0,24000000,1,4,17),
('2022-03-20',24000000,0,24000000,1,5,18),
--THÁNG 4
('2022-04-01',24000000,0,24000000,1,4,10),
('2022-04-02',24000000,0,24000000,1,5,11),
('2022-04-03',24000000,0,24000000,1,3,11),
('2022-04-04',24000000,0,24000000,1,4,12),
('2022-04-05',24000000,0,24000000,1,5,13),
('2022-04-06',24000000,0,24000000,1,4,14),
('2022-04-07',24000000,0,24000000,1,5,15),
('2022-04-08',24000000,0,24000000,1,3,16),
('2022-04-09',24000000,0,24000000,1,4,17),
('2022-04-10',24000000,0,24000000,1,5,18),

('2022-04-11',24000000,0,24000000,1,4,10),
('2022-04-12',24000000,0,24000000,1,5,11),
('2022-04-13',24000000,0,24000000,1,3,11),
('2022-04-14',24000000,0,24000000,1,4,12),
('2022-04-15',24000000,0,24000000,1,5,13),
('2022-04-16',24000000,0,24000000,1,4,14),
('2022-04-17',24000000,0,24000000,1,5,15),
('2022-04-18',24000000,0,24000000,1,3,16),
('2022-04-19',24000000,0,24000000,1,4,17),
('2022-04-20',24000000,0,24000000,1,5,18),
--THÁNG 5
('2022-05-01',24000000,0,24000000,1,4,10),
('2022-05-02',24000000,0,24000000,1,5,11),
('2022-05-03',24000000,0,24000000,1,3,11),
('2022-05-04',24000000,0,24000000,1,4,12),
('2022-05-05',24000000,0,24000000,1,5,13),
('2022-05-06',24000000,0,24000000,1,4,14),
('2022-05-07',24000000,0,24000000,1,5,15),
('2022-05-08',24000000,0,24000000,1,3,16),
('2022-05-09',24000000,0,24000000,1,4,17),
('2022-05-10',24000000,0,24000000,1,5,18),

('2022-05-11',24000000,0,24000000,1,4,10),
('2022-05-12',24000000,0,24000000,1,5,11),
('2022-05-13',24000000,0,24000000,1,3,11),
('2022-05-14',24000000,0,24000000,1,4,12),
('2022-05-15',24000000,0,24000000,1,5,13),
('2022-05-16',24000000,0,24000000,1,4,14),
('2022-05-17',24000000,0,24000000,1,5,15),
('2022-05-18',24000000,0,24000000,1,3,16),
('2022-05-19',24000000,0,24000000,1,4,17),
('2022-05-20',24000000,0,24000000,1,5,18),
--THÁNG 6
('2022-06-01',24000000,0,24000000,1,4,10),
('2022-06-02',24000000,0,24000000,1,5,11),
('2022-06-03',24000000,0,24000000,1,3,11),
('2022-06-04',24000000,0,24000000,1,4,12),
('2022-06-05',24000000,0,24000000,1,5,13),
('2022-06-06',24000000,0,24000000,1,4,14),
('2022-06-07',24000000,0,24000000,1,5,15),
('2022-06-08',24000000,0,24000000,1,3,16),
('2022-06-09',24000000,0,24000000,1,4,17),
('2022-06-10',24000000,0,24000000,1,5,18),

('2022-06-11',24000000,0,24000000,1,4,10),
('2022-06-12',24000000,0,24000000,1,5,11),
('2022-06-13',24000000,0,24000000,1,3,11),
('2022-06-14',24000000,0,24000000,1,4,12),
('2022-06-15',24000000,0,24000000,1,5,13),
('2022-06-16',24000000,0,24000000,1,4,14),
('2022-06-17',24000000,0,24000000,1,5,15),
('2022-06-18',24000000,0,24000000,1,3,16),
('2022-06-19',24000000,0,24000000,1,4,17),
('2022-06-20',24000000,0,24000000,1,5,18),
--THÁNG 7
('2022-07-01',24000000,0,24000000,1,4,10),
('2022-07-02',24000000,0,24000000,1,5,11),
('2022-07-03',24000000,0,24000000,1,3,11),
('2022-07-04',24000000,0,24000000,1,4,12),
('2022-07-05',24000000,0,24000000,1,5,13),
('2022-07-06',24000000,0,24000000,1,4,14),
('2022-07-07',24000000,0,24000000,1,5,15),
('2022-07-08',24000000,0,24000000,1,3,16),
('2022-07-09',24000000,0,24000000,1,4,17),
('2022-07-10',24000000,0,24000000,1,5,18),

('2022-07-11',24000000,0,24000000,1,4,10),
('2022-07-12',24000000,0,24000000,1,5,11),
('2022-07-13',24000000,0,24000000,1,3,11),
('2022-07-14',24000000,0,24000000,1,4,12),
('2022-07-15',24000000,0,24000000,1,5,13),
('2022-07-16',24000000,0,24000000,1,4,14),
('2022-07-17',24000000,0,24000000,1,5,15),
('2022-07-18',24000000,0,24000000,1,3,16),
('2022-07-19',24000000,0,24000000,1,4,17),
('2022-07-20',24000000,0,24000000,1,5,18),
--THÁNG 8
('2022-08-01',24000000,0,24000000,1,4,10),
('2022-08-02',24000000,0,24000000,1,5,11),
('2022-08-03',24000000,0,24000000,1,3,11),
('2022-08-04',24000000,0,24000000,1,4,12),
('2022-08-05',24000000,0,24000000,1,5,13),
('2022-08-06',24000000,0,24000000,1,4,14),
('2022-08-07',24000000,0,24000000,1,5,15),
('2022-08-08',24000000,0,24000000,1,3,16),
('2022-08-09',24000000,0,24000000,1,4,17),
('2022-08-10',24000000,0,24000000,1,5,18),

('2022-08-11',24000000,0,24000000,1,4,10),
('2022-08-12',24000000,0,24000000,1,5,11),
('2022-08-13',24000000,0,24000000,1,3,11),
('2022-08-14',24000000,0,24000000,1,4,12),
('2022-08-15',24000000,0,24000000,1,5,13),
('2022-08-16',24000000,0,24000000,1,4,14),
('2022-08-17',24000000,0,24000000,1,5,15),
('2022-08-18',24000000,0,24000000,1,3,16),
('2022-08-19',24000000,0,24000000,1,4,17),
('2022-08-20',24000000,0,24000000,1,5,18),
--THÁNG 9
('2022-09-01',24000000,0,24000000,1,4,10),
('2022-09-02',24000000,0,24000000,1,5,11),
('2022-09-03',24000000,0,24000000,1,3,11),
('2022-09-04',24000000,0,24000000,1,4,12),
('2022-09-05',24000000,0,24000000,1,5,13),
('2022-09-06',24000000,0,24000000,1,4,14),
('2022-09-07',24000000,0,24000000,1,5,15),
('2022-09-08',24000000,0,24000000,1,3,16),
('2022-09-09',24000000,0,24000000,1,4,17),
('2022-09-10',24000000,0,24000000,1,5,18),

('2022-09-11',24000000,0,24000000,1,4,10),
('2022-09-12',24000000,0,24000000,1,5,11),
('2022-09-13',24000000,0,24000000,1,3,11),
('2022-09-14',24000000,0,24000000,1,4,12),
('2022-09-15',24000000,0,24000000,1,5,13),
('2022-09-16',24000000,0,24000000,1,4,14),
('2022-09-17',24000000,0,24000000,1,5,15),
('2022-09-18',24000000,0,24000000,1,3,16),
('2022-09-19',24000000,0,24000000,1,4,17),
('2022-09-20',24000000,0,24000000,1,5,18),
--THÁNG 10
('2022-10-01',24000000,0,24000000,1,4,10),
('2022-10-02',24000000,0,24000000,1,5,11),
('2022-10-03',24000000,0,24000000,1,3,11),
('2022-10-04',24000000,0,24000000,1,4,12),
('2022-10-05',24000000,0,24000000,1,5,13),
('2022-10-06',24000000,0,24000000,1,4,14),
('2022-10-07',24000000,0,24000000,1,5,15),
('2022-10-08',24000000,0,24000000,1,3,16),
('2022-10-09',24000000,0,24000000,1,4,17),
('2022-10-10',24000000,0,24000000,1,5,18),

('2022-10-11',24000000,0,24000000,1,4,10),
('2022-10-12',24000000,0,24000000,1,5,11),
('2022-10-13',24000000,0,24000000,1,3,11),
('2022-10-14',24000000,0,24000000,1,4,12),
('2022-10-15',24000000,0,24000000,1,5,13),
('2022-10-16',24000000,0,24000000,1,4,14),
('2022-10-17',24000000,0,24000000,1,5,15),
('2022-10-18',24000000,0,24000000,1,3,16),
('2022-10-19',24000000,0,24000000,1,4,17),
('2022-10-20',24000000,0,24000000,1,5,18),

('2022-10-11',24000000,0,24000000,1,4,10),
('2022-10-12',24000000,0,24000000,1,5,11),
('2022-10-13',24000000,0,24000000,1,3,11),
('2022-10-14',24000000,0,24000000,1,4,12),
('2022-10-15',24000000,0,24000000,1,5,13),
('2022-10-16',24000000,0,24000000,1,4,14),
('2022-10-17',24000000,0,24000000,1,5,15),
('2022-10-18',24000000,0,24000000,1,3,16),
('2022-10-19',24000000,0,24000000,1,4,17),
('2022-10-20',24000000,0,24000000,1,5,18),
('2022-09-20',24000000,0,24000000,1,5,18),
--THÁNG 11
('2022-11-01',24000000,0,24000000,1,4,10),
('2022-11-02',24000000,0,24000000,1,5,11),
('2022-11-03',24000000,0,24000000,1,3,11),
('2022-11-04',24000000,0,24000000,1,4,12),
('2022-11-05',24000000,0,24000000,1,5,13),
('2022-11-06',24000000,0,24000000,1,4,14),
('2022-11-07',24000000,0,24000000,1,5,15),
('2022-11-08',24000000,0,24000000,1,3,16),
('2022-11-09',24000000,0,24000000,1,4,17),
('2022-11-10',24000000,0,24000000,1,5,18),

('2022-11-11',24000000,0,24000000,1,4,10),
('2022-11-12',24000000,0,24000000,1,5,11),
('2022-11-13',24000000,0,24000000,1,3,11),
('2022-11-14',24000000,0,24000000,1,4,12),
('2022-11-15',24000000,0,24000000,1,5,13),
('2022-11-16',24000000,0,24000000,1,4,14),
('2022-11-17',24000000,0,24000000,1,5,15),
('2022-11-18',24000000,0,24000000,1,3,16),
('2022-11-19',24000000,0,24000000,1,4,17),
('2022-11-20',24000000,0,24000000,1,5,18),
--THÁNG 12
('2022-12-01',24000000,0,24000000,1,4,10),
('2022-12-02',24000000,0,24000000,1,5,11),
('2022-12-03',24000000,0,24000000,1,3,11),
('2022-12-04',24000000,0,24000000,1,4,12),
('2022-12-05',24000000,0,24000000,1,5,13),
('2022-12-06',24000000,0,24000000,1,4,14),
('2022-12-07',24000000,0,24000000,1,5,15),
('2022-12-08',24000000,0,24000000,1,3,16),
('2022-12-09',24000000,0,24000000,1,4,17),
('2022-12-10',24000000,0,24000000,1,5,18)

-- PHIẾU NHẬP

--CHI TIẾT ĐƠN HÀNG
GO
INSERT INTO CTHD
VALUES
(1,1200000,1,1,1200000,N'Hồng đất'),
(1,1200000,1,2,1200000,N'Hồng đất'),
(1,1200000,1,3,1200000,N'Hồng đất'),
(1,1200000,1,4,1200000,N'Hồng đất'),
(1,1200000,2,5,1200000,N'Hồng đất'),
(1,1200000,2,6,1200000,N'Hồng đất'),
(1,1200000,2,7,1200000,N'Hồng đất'),
(1,1200000,2,8,1200000,N'Hồng đất'),
(1,1200000,3,9,1200000,N'Hồng đất'),
(1,1200000,3,10,1200000,N'Hồng đất'),
(1,1200000,3,11,1200000,N'Hồng đất'),
(1,1200000,3,12,1200000,N'Hồng đất'),
(1,1200000,4,13,1200000,N'Hồng đất'),
(1,1200000,4,14,1200000,N'Hồng đất'),
(1,1200000,4,15,1200000,N'Hồng đất'),
(1,1200000,4,16,1200000,N'Hồng đất'),
(1,1200000,5,17,1200000,N'Hồng đất'),
(1,1200000,5,18,1200000,N'Hồng đất'),
(1,1200000,5,19,1200000,N'Hồng đất'),
(1,1200000,5,20,1200000,N'Hồng đất'),
(1,1200000,6,21,1200000,N'Hồng đất'),
(1,1200000,6,22,1200000,N'Hồng đất'),
(1,1200000,6,23,1200000,N'Hồng đất'),
(1,1200000,6,24,1200000,N'Hồng đất')

-- PHIẾU NHẬP
GO

INSERT INTO PHIEUNHAP
VALUES
('2023-10-08',55860000,10,1,1,1),
('2023-11-08',55860000,10,1,3,1),
('2023-12-08',55860000,10,1,3,1),
('2023-1-08',55860000,10,1,2,2),
('2023-2-08',55860000,10,1,5,2),
('2023-3-08',55860000,10,1,5,2),
('2023-4-08',55860000,10,1,1,2),
('2023-5-08',55860000,10,1,4,3),
('2023-6-08',55860000,10,1,4,3),
('2023-8-08',55860000,10,1,2,3),
('2023-01-08',55860000,10,1,1,1),
('2023-02-08',55860000,10,1,3,1),
('2023-03-08',55860000,10,1,3,1),
('2023-04-08',55860000,10,1,2,2),
('2023-05-08',55860000,10,1,5,2),
('2023-06-08',55860000,10,1,5,2),
('2023-07-08',55860000,10,1,1,2),
('2023-08-08',55860000,10,1,4,3),
('2023-09-09',55860000,10,1,4,3),
('2023-11-09',55860000,10,1,2,3)

--CHI TIẾT PHIẾU NHẬP
GO
INSERT INTO CTPN
VALUES
(100,1200000,1200000,1,1 ,N'Hồng đất'),
(100,1200000,1200000,2,2,N'Hồng đất' ),
(100,1200000,1200000,3,3,N'Hồng đất' ),
(100,1200000,1200000,4,4,N'Hồng đất' ),
(100,3800000,3800000,2,5,N'Hồng đất' ),
(100,3800000,3800000,6,6 ,N'Hồng đất'),
(100,1400000,1400000,7,7 ,N'Hồng đất'),
(100,1900000,1900000,8,8,N'Hồng đất' ),
(100,1200000,1200000,9,9 ,N'Hồng đất'),
(100,1200000,1200000,11,10 ,N'Hồng đất'),
(100,1200000,1200000,12,11,N'Hồng đất'),
(100,1200000,1200000,13,12,N'Hồng đất'),
(100,1200000,1200000,14,13 ,N'Hồng đất'),
(100,1200000,1200000,15,14,N'Hồng đất' ),
(100,1200000,1200000,16,15,N'Hồng đất' ),
(100,1200000,1200000,17,16,N'Hồng đất' ),
(100,200000,200000,18,17,N'Hồng đất' ),
(100,200000,200000,19,18,N'Hồng đất'),
(100,200000,200000,20,19,N'Hồng đất' )
-- insert thêm 
/*GO
SELECT * FROM HOADON
INSERT INTO HOADON
VALUES
(GETDATE(),24000000,0,24000000,0,4,10),
(GETDATE(),24000000,0,24000000,0,5,11),
(GETDATE(),24000000,0,24000000,0,3,11),
(GETDATE(),24000000,0,24000000,0,4,12),
(GETDATE(),24000000,0,24000000,0,5,13),
(GETDATE(),24000000,0,24000000,0,4,14),
(GETDATE(),24000000,0,24000000,0,5,15),
(GETDATE(),24000000,0,24000000,0,3,16),
(GETDATE(),24000000,0,24000000,0,4,17),
(GETDATE(),24000000,0,24000000,0,5,18)*/
GO
--TÍNH TỔNG SỐ TIỀN BÁN ĐƯỢC QUA TỪNG THÁNG

-- Proc HÓA ĐƠN tìm theo ngày, tháng năm
GO
CREATE OR ALTER PROC doanhThu_Nam(@Year NVARCHAR(MAX))
AS BEGIN 
	SELECT MaHD,NgayTao,B.UserName, TongTien
	FROM HOADON A JOIN ACCOUNT B ON A.IDAccount = B.MaAccount
	WHERE NgayTao= @Year
END

-- Proc HÓA ĐƠN tìm theo  tháng
GO
CREATE OR ALTER  PROC doanhThu_Thang(@month NVARCHAR(MAX))
AS BEGIN 
	SELECT MaHD,NgayTao,B.UserName, TongTien
	FROM HOADON A JOIN ACCOUNT B ON A.IDAccount = B.MaAccount
	WHERE MONTH(NgayTao)= @month
END

-- Proc PHIẾU NHẬP tìm theo tháng năm
GO
CREATE OR ALTER PROC PhieuNhap_Nam(@year NVARCHAR(MAX))
AS
BEGIN 
	SELECT MaPN,NgayTao,B.UserName, ThanhTien, A.MaAccount
	FROM PHIEUNHAP A JOIN ACCOUNT B ON A.MaAccount = B.MaAccount
	WHERE YEAR(NgayTao)= @year
END

GO
CREATE OR ALTER PROC PhieuNhap_Thang(@month NVARCHAR(MAX))
AS BEGIN 
	SELECT MaPN,NgayTao,B.UserName, ThanhTien, A.MaAccount
	FROM PHIEUNHAP A JOIN ACCOUNT B ON A.MaAccount = B.MaAccount
	WHERE MONTH(NgayTao)= @month
END

--PRO HoaDon theo Nam 
GO
CREATE OR ALTER PROC sp_HoaDonTheoNam(@year int)
AS BEGIN 
	SELECT MaHD, NgayTao, TongTien, Sale, ThanhTien, TrangThai, MaNV, MaKH
	FROM HoaDon
	WHERE YEAR(NgayTao)= @year
END


--PRO HoaDon theo Thang 
GO
CREATE OR ALTER  PROC sp_HoaDonTheoThang(@month int)
AS BEGIN 
	SELECT MaHD, NgayTao, TongTien, Sale, ThanhTien, TrangThai, MaNV, MaKH
	FROM HoaDon
	WHERE MONTH(NgayTao)= @month
END

--PRO HoaDon theo ngay 
GO
CREATE OR ALTER PROC sp_HoaDonTheoNgay(@month int)
AS BEGIN 
	SELECT MaHD, NgayTao, TongTien, Sale, ThanhTien, TrangThai, MaNV, MaKH
	FROM HoaDon
	WHERE DAY(NgayTao)= @month
END

-- PROC DOANH THU THEO NGÀY
-- NẾU KHOẢNG CÁCH GIỮA CÁC NGÀY LÀ < THÁNG NGÀY HIỂN THỊ BIỂU ĐỒ THEO DẠNG NGÀY
-- NẾU KHOẢNG CÁCH LỚN HƠN > THÁNG NGÀY HIỂN THỊ BIỂU ĐỒ DẠNG TUẦN
--NẾU KHOẢNG CÁCH LỚN HƠN 1 THÁNG HIỂN THỊ BIỂU ĐỒ DƯỚI DẠNG THÁNG
GO
CREATE OR ALTER PROC sp_DoanhThuNgay(@NGAYMIN DATE, @NGAYMAX DATE)
AS BEGIN
	WHILE('2022-12-1' <= '2023-1-1')
	SELECT SUM(ThanhTien) FROM HOADON WHERE TrangThai=1 AND (NgayTao BETWEEN '2022-12-1' AND '2023-1-1')
END

---------KIỂM KÊ

SELECT sp.MaSP, sp.TenSP,ctkk.VungKiemKe FROM CHITIETKIEMKE ctkk INNER JOIN SANPHAM sp ON ctkk.MaSP = sp.MaSP
------PROCEDURE KIỂM KÊ----CÒN BỊ LỖI----
CREATE OR ALTER PROC sp_SoLuongTonKho(@IDSanPham int)
AS BEGIN
	SELECT (CTPN.SL - CTHD.MaSP),CTPN.MaSP
	FROM CTPN INNER JOIN CTHD ON CTPN.MaSP = CTHD.MaSP 
	WHERE CTPN.MaSP = @IDSanPham	
END

SELECT * FROM CTPN
SELECT * FROM CTPN INNER JOIN CTHD ON CTPN.MaSP = CTHD.MaSP 
WHERE CTPN.MaSP = 1
----------------------------

CREATE OR ALTER PROC sp_ChiTietKiemKe(@IDKiemKe int)
AS BEGIN
	SELECT sp.MaSP, sp.TenSP,ctkk.VungKiemKe,/*số lượng kho*/ AS SoLuongKiemToan,ctkk.SoLuong AS SLThucTe, (ctkk.SoLuong - /*Số lượng kho*/) AS ChenhLech
	FROM CHITIETKIEMKE ctkk INNER JOIN SANPHAM sp ON ctkk.MaSP = sp.MaSP
	WHERE MaKiemKe = @IDKiemKe
END


sp_ChiTietKiemKe 1